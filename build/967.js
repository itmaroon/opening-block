(globalThis.webpackChunkopening_block=globalThis.webpackChunkopening_block||[]).push([[967],{384:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>L});var o=n(609),l=n(723),a=n(427),i=n(715),r=n(87);const s=({attributes:e,setAttributes:t})=>{const n={thin:200,light:300,regular:400,medium:500,semibold:600,bold:700,black:900};return(0,r.useEffect)((()=>(fetch(opening_block.plugin_url+"/build/fileList.json").then((e=>e.json())).then((e=>{const o=e.map((e=>{const t=e.match(/(.*)-(.*)\.ttf/),o=t[2].includes("Italic")?"italic":"normal",l=t[2].replace("Italic","").trim().toLowerCase(),a=n[l]||"400",i=document.createElement("style");return i.textContent=`\n            @font-face {\n              font-family: '${t[1]}';\n              src: url('${opening_block.plugin_url}/assets/fonts/${t[0]}') format('truetype');\n              font-weight: ${a};\n              font-style: ${o};\n            }\n          `,document.head.appendChild(i),{value:t[0],label:`${t[1]} ${l}`,fontFamily:t[1],fontWeight:a,fontStyle:o}}));t({fontFamilyOptions:o})})).catch((e=>console.error("Error:",e))),()=>{Array.from(document.querySelectorAll("#custom-font-face")).forEach((e=>e.remove()))})),[]),null};var c;function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},g.apply(this,arguments)}var p,d=function(e){return o.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},e),c||(c=o.createElement("path",{d:"M464 256a208 208 0 1 0-416 0 208 208 0 1 0 416 0M0 256a256 256 0 1 1 512 0 256 256 0 1 1-512 0m188.3-108.9c7.6-4.2 16.8-4.1 24.3.5l144 88c7.1 4.4 11.5 12.1 11.5 20.5s-4.4 16.1-11.5 20.5l-144 88c-7.4 4.5-16.7 4.7-24.3.5S176 352.9 176 344.2V168c0-8.7 4.7-16.7 12.3-20.9"})))};function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},m.apply(this,arguments)}var u,h=function(e){return o.createElement("svg",m({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"},e),p||(p=o.createElement("path",{d:"M350 177.5c3.8-8.8 2-19-4.6-26l-136-144C204.9 2.7 198.6 0 192 0s-12.9 2.7-17.4 7.5l-136 144c-6.6 7-8.4 17.2-4.6 26S46.5 192 56 192h88v192c0 17.7-14.3 32-32 32H32c-17.7 0-32 14.3-32 32v32c0 17.7 14.3 32 32 32h80c70.7 0 128-57.3 128-128V192h88c9.6 0 18.2-5.7 22-14.5"})))};function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_.apply(this,arguments)}var b=function(e){return o.createElement("svg",_({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512"},e),u||(u=o.createElement("path",{d:"M350 334.5c3.8 8.8 2 19-4.6 26l-136 144c-4.5 4.8-10.8 7.5-17.4 7.5s-12.9-2.7-17.4-7.5l-136-144c-6.6-7-8.4-17.2-4.6-26S46.5 320 56 320h88V128c0-17.7-14.3-32-32-32H32C14.3 96 0 81.7 0 64V32C0 14.3 14.3 0 32 0h80c70.7 0 128 57.3 128 128v192h88c9.6 0 18.2 5.7 22 14.5"})))};const f=(e,t,n)=>{const o=e.querySelector("#splash"),l=e.querySelector("#splash_logo"),a=e.querySelector(".splashbg"),i=e.querySelector(".splashbg2"),r=e.querySelector(".splashCirclebg"),s=e.querySelector(".fixbg"),c=()=>{s.classList.remove("hide"),a.classList.remove("appear"),a.classList.remove(t),i.classList.remove("appear"),i.classList.remove(t),o.classList.remove("hide"),l.animate([{opacity:1}],{duration:0,fill:"both"}),o.animate([{opacity:1}],{duration:0,fill:"both"}),n(!1)},g=()=>{a.classList.remove("appear"),a.classList.remove(t),s.classList.remove("disappear"),o.animate([{opacity:1}],{duration:0,fill:"both"}),l.animate([{opacity:1}],{duration:0,fill:"both"}),n(!1)},p=()=>{a.classList.add("appear"),a.classList.add(t),s.classList.add("disappear"),s.addEventListener("transitionend",g)},d=()=>{r.classList.remove("appear"),s.classList.remove("disappear"),o.animate([{opacity:1}],{duration:0,fill:"both"}),l.animate([{opacity:1}],{duration:0,fill:"both"}),n(!1)},m=()=>{r.classList.add("appear"),s.classList.add("disappear"),s.addEventListener("transitionend",d)},u=()=>{"virtical_open"===t||"horizen_open"===t?(s.classList.add("hide"),o.animate([{opacity:0}],{duration:0,fill:"both"}),a.classList.add("appear"),a.classList.add(t),i.classList.add("appear"),i.classList.add(t),i.addEventListener("animationend",c)):"virtical_slide"===t||"horizen_slide"===t?o.animate([{opacity:1},{opacity:0}],{delay:800,duration:1e3,fill:"both"}).addEventListener("finish",p):"circle_expand"===t&&o.animate([{opacity:1},{opacity:0}],{delay:800,duration:1e3,fill:"both"}).addEventListener("finish",m)};return l.animate([{opacity:1},{opacity:0}],{delay:800,duration:1e3,fill:"both"}).addEventListener("finish",u),()=>{i.removeEventListener("animationend",c),s.removeEventListener("transitionend",g),o.removeEventListener("finish",p),s.removeEventListener("transitionend",d),o.removeEventListener("finish",m),l.removeEventListener("finish",u)}};function v({attributes:e,onChange:t}){const{ending_type:n,is_anime:r,is_front:s,trigger_anime:c}=e;return(0,o.createElement)(o.Fragment,null,(0,o.createElement)(i.InspectorControls,{group:"settings"},(0,o.createElement)(a.PanelBody,{title:(0,l.__)("Ending Animation","opening-block"),initialOpen:!0,className:"ending_ctrl"},(0,o.createElement)(a.RadioControl,{selected:n,options:[{label:(0,l.__)("Vertical Slide","opening-block"),value:"virtical_slide"},{label:(0,l.__)("Horizen Slide","opening-block"),value:"horizen_slide"},{label:(0,l.__)("Vertical Open","opening-block"),value:"virtical_open"},{label:(0,l.__)("Horizen Open","opening-block"),value:"horizen_open"},{label:(0,l.__)("Circle Expand","opening-block"),value:"circle_expand"}],onChange:e=>{t({ending_type:e})}}))),(0,o.createElement)(i.BlockControls,null,(0,o.createElement)(a.Toolbar,null,(0,o.createElement)(a.Button,{label:r?(0,l.__)("Running","opening-block"):(0,l.__)("Stopped","opening-block"),icon:d,onClick:()=>{t({trigger_anime:!c})},disabled:!s||r}),(0,o.createElement)(a.Button,{label:s?(0,l.__)("To Front","opening-block"):(0,l.__)("To Back","opening-block"),icon:s?b:h,onClick:()=>{t({is_front:!s})},disabled:!!r}))))}var y=n(945),k=n(734),E=n(143);function C({isFront:e,onChange:t}){var[n,a]=(0,r.useState)(null);if((0,r.useEffect)((function(){fetch(`${opening_block.home_url}/wp-json/itmar-rest-api/v1/is-block-registered/?block_name=itmar/design-checkbox`).then((e=>e.json())).then((e=>{a(e.registered),e.registered?t({is_check_enable:!0}):(t({is_check_enable:!1}),(0,E.dispatch)("core/notices").createNotice("error",(0,l.__)("The plugin that displays the Skip opening checkbox is not enabled.","opening-block"),{type:"snackbar"}))})).catch((e=>console.error("エラー:",e)))}),[]),null===n)return(0,o.createElement)("div",{className:"opening_check waiting",style:{display:"block"}},(0,l.__)("Checking block status...","opening-block"));if(n){const t=[["itmar/design-checkbox",{inputName:"anim_is_skip",labelContent:(0,l.__)("The opening will not be displayed next time.","opening-block"),bgColor:"transparent",labelColor:"#ffffff"}]];return(0,o.createElement)("div",{className:"opening_check "+(e?"":"closing"),style:{display:"block"}},(0,o.createElement)(i.InnerBlocks,{template:t,templateLock:"all"}))}return null}function L({attributes:e,setAttributes:t}){const{bg_Color:n,bg_Gradient:c,logo_text:g,logo_font:p,char_paths:d,logo_size:m,logo_width:u,logo_height:h,logo_gap:_,logo_strokeColor:b,logo_fillColor:E,logo_fillGradient:L,trigger_anime:w,is_front:x,fontFamilyOptions:S,ending_type:O}=e,B=n||c,F=E||L,N={option:(e,t)=>({...e,fontFamily:t.data.fontFamily,fontWeight:t.data.fontWeight,fontStyle:t.data.fontStyle})},P=(0,r.useRef)(null),T=(0,r.useRef)(null),j=(0,i.useBlockProps)({ref:P,style:x?{}:{zIndex:-1,opacity:0}});return(0,r.useEffect)((()=>{y.Ay.load(opening_block.plugin_url+`/assets/fonts/${p}`,((e,n)=>{if(e)console.error("Could not load the font: "+e);else{const e=g.split("");let o=[],l=0,a=0;e.map(((e,t)=>{const i=n.getPath(e,l,0,m),r=i.getBoundingBox();l+=r.x2-r.x1+_,a=a>r.y2-r.y1?a:r.y2-r.y1,o.push(i.toPathData())})),t({logo_width:l}),t({logo_height:a}),t({char_paths:o})}}))}),[g,p,m,_]),(0,r.useEffect)((()=>{if(P.current&&w){const e=P.current.querySelector("#logo_anime"),n=e.getElementsByTagName("path");for(let e of n){const t=e.getTotalLength();e.style.strokeDasharray=t,e.style.strokeDashoffset=t}t({is_anime:!0}),e.classList.remove("done");const o=e=>{t({is_anime:e,is_front:e,trigger_anime:e})},l=t=>{Array.from(t).forEach(((n,l)=>{const a=n.getTotalLength();n.animate([{strokeDashoffset:a},{strokeDashoffset:0}],{duration:1e3,fill:"both",delay:800*l}).addEventListener("finish",(()=>{if(l===t.length-1){e.classList.add("done");for(let e of t)e.style.strokeDashoffset="",e.style.strokeDasharray="";T.current=f(P.current,O,o)}}))}))};l(n)}return()=>{"function"==typeof T.current&&T.current()}}),[w]),(0,o.createElement)(o.Fragment,null,(0,o.createElement)(s,{attributes:e,setAttributes:t}),(0,o.createElement)(i.InspectorControls,{group:"settings"},(0,o.createElement)(a.PanelBody,{title:(0,l.__)("Background Settings","opening-block"),initialOpen:!0,className:"back_design_ctrl"},(0,o.createElement)(i.__experimentalPanelColorGradientSettings,{title:(0,l.__)("Background Color Setting","opening-block"),settings:[{colorValue:n,gradientValue:c,label:(0,l.__)("Choice color or gradient","opening-block"),onColorChange:e=>{t({bg_Color:void 0===e?"":e})},onGradientChange:e=>{t({bg_Gradient:e})}}]})),(0,o.createElement)(a.PanelBody,{title:(0,l.__)("Logo Settings","opening-block"),initialOpen:!0,className:"logo_design_ctrl"},(0,o.createElement)(a.PanelRow,null,(0,o.createElement)(a.TextControl,{label:(0,l.__)("Logo Letters","opening-block"),labelPosition:"top",value:g,isPressEnterToChange:!0,onChange:e=>t({logo_text:e})})),(0,o.createElement)((({label:e,value:n})=>(0,o.createElement)(o.Fragment,null,e&&(0,o.createElement)("label",{className:"components-base-control__label"},e),(0,o.createElement)(k.Ay,{options:S,value:S.find((e=>e.value===n)),onChange:e=>{t({logo_font:e?e.value:""})},styles:N}))),{label:(0,l.__)("Font Family","opening-block"),value:p}),(0,o.createElement)(a.PanelRow,{className:"logoSizeCtrl"},(0,o.createElement)(a.RangeControl,{value:m,label:(0,l.__)("Logo Size","opening-block"),max:100,min:10,onChange:e=>t({logo_size:e}),separatorType:"none",step:5,withInputField:!1})),(0,o.createElement)(a.PanelRow,{className:"logoSizeCtrl"},(0,o.createElement)(a.RangeControl,{value:_,label:(0,l.__)("Logo Spacing","opening-block"),max:20,min:1,onChange:e=>t({logo_gap:e}),separatorType:"none",step:1,withInputField:!1})),(0,o.createElement)(i.__experimentalPanelColorGradientSettings,{title:(0,l.__)("Logo Color Setting","opening-block"),settings:[{colorValue:b,label:(0,l.__)("Stroke color","opening-block"),onColorChange:e=>t({logo_strokeColor:e})},{colorValue:E,gradientValue:L,label:(0,l.__)("Fill Color","opening-block"),onColorChange:e=>t({logo_fillColor:e}),onGradientChange:e=>t({logo_fillGradient:e})}]}))),(0,o.createElement)(v,{attributes:e,onChange:e=>{t(e)}}),(0,o.createElement)("div",{...j},(0,o.createElement)("div",{id:"splash",style:{background:B,display:x?"block":"none"}},(0,o.createElement)("div",{id:"splash_logo"},(0,o.createElement)("svg",{id:"logo_anime",className:"done",width:"250px",height:"120px",viewBox:`${u/2-125} ${-60-h/2} 250 120`},(0,o.createElement)("g",null,d.map(((e,t)=>(0,o.createElement)("path",{key:t,style:{fill:F,stroke:b},d:e}))))))),(0,o.createElement)("div",{className:"fixbg"}),(0,o.createElement)("div",{className:"splashbg",style:{background:B}}),(0,o.createElement)("div",{className:"splashbg2",style:{background:B}}),(0,o.createElement)("div",{className:"splashCirclebg",style:{background:B}})),(0,o.createElement)(C,{isFront:x,onChange:e=>t(e)}))}},256:()=>{}}]);